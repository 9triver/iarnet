## 3.4 面向算力网络的智能应用运行平台原型

基于前述的分级资源调度方法，本研究设计并实现了一个面向算力网络的智能应用运行平台原型。该平台通过直观的Web界面，为用户提供了算力资源管理和应用部署管理的一体化解决方案，实现了算力网络资源的高效利用和应用的便捷部署。本小节将详细介绍该平台原型的主要功能模块及其实现效果。

### 3.4.1 平台概述

面向算力网络的智能应用运行平台原型采用前后端分离的架构设计，前端基于Next.js 15和React 19构建，提供现代化的用户界面；后端基于Go语言实现，提供高性能的API服务。平台核心功能包括：

1. **算力资源管理**：支持多种异构算力资源的统一接入和管理，包括Docker容器、Kubernetes集群等。
2. **应用部署管理**：支持从Git仓库导入应用，配置部署参数，实现一键部署和生命周期管理。

平台通过Web界面为用户提供了友好的交互体验，使得复杂的算力网络资源管理和应用部署操作变得简单直观。

### 3.4.2 算力资源管理功能

算力资源管理是平台的基础功能模块，用户可以通过Web界面完成资源的接入、查看和管理操作。平台将资源分为本地资源（local_providers）和远程资源（remote_providers）两类进行管理，分别展示在独立的资源列表中。

#### 3.4.2.1 资源查看功能

平台提供了直观的资源查看界面，用户可以实时查看已接入的算力资源及其状态信息。资源查看界面主要包括以下内容：

- **资源列表展示**：以表格形式展示所有已接入的资源，包括资源名称、类型、状态、连接地址等基本信息。资源按本地资源和远程资源分类展示，每个资源显示其ID、名称、类型（Kubernetes、Docker、VM）、主机地址和端口号。

- **资源状态监控**：实时显示资源的连接状态（已连接、已断开、错误等），并通过颜色标识直观展示资源健康状态。已连接状态显示为绿色标识，已断开状态显示为灰色标识，错误状态显示为红色标识。

- **资源使用情况**：展示每个资源的资源使用情况，包括CPU和内存的总容量、已使用量和可用量。资源使用情况以数值形式展示，并显示使用百分比，帮助用户快速了解资源的负载情况。

- **全局资源容量统计**：在页面顶部展示全局资源容量统计信息，包括总CPU、总内存、已使用CPU、已使用内存、可用CPU、可用内存等指标，为用户提供资源的整体视图。

![资源查看界面](images/3.4.1-resource-view.png)
_图3-5 算力资源查看界面_

#### 3.4.2.2 资源接入功能

平台支持通过Web界面便捷地接入新的算力资源。资源接入功能主要包括：

- **资源类型选择**：支持选择不同的资源类型，包括Kubernetes、Docker、VM等，系统会根据资源类型提供相应的配置表单。

- **连接参数配置**：通过表单输入资源的连接参数，包括资源名称、资源类型、主机地址（host）、端口号（port）、认证Token等。对于Docker类型的资源，系统支持配置TLS证书路径和API版本；对于Kubernetes类型的资源，系统支持配置kubeconfig内容和命名空间。

- **资源描述**：支持为资源添加描述信息，帮助用户记录资源的用途和配置说明。

- **资源注册**：点击提交按钮后，系统会将资源信息发送到后端API进行注册，后端会根据资源类型创建相应的Provider适配器，并尝试连接资源以验证配置的正确性。

资源接入界面采用对话框（Dialog）形式，提供清晰的表单布局和输入验证，降低了资源接入的操作复杂度。

![资源接入界面](images/3.4.2-resource-add.png)
_图3-6 算力资源接入界面_

#### 3.4.2.3 资源管理功能

平台提供了完善的资源管理功能，用户可以对已接入的资源进行管理操作：

- **资源编辑**：点击编辑按钮，可以修改资源的配置参数，如资源名称、主机地址、端口号、认证Token等。编辑操作通过对话框表单实现，用户可以方便地更新资源配置。

- **资源删除**：点击删除按钮，可以删除不再使用的资源。删除操作会调用后端API，系统会检查资源是否正在被应用使用，确保删除操作的安全性。

- **资源刷新**：点击刷新按钮，可以手动刷新资源状态，更新资源的连接状态和使用情况。刷新操作会重新调用后端API获取最新的资源信息。

- **资源状态更新**：系统会定期自动刷新资源状态，确保资源信息的实时性。资源状态包括连接状态（connected/disconnected/error）和资源使用情况（CPU、内存使用量）。

### 3.4.3 应用部署管理功能

应用部署管理是平台的核心功能模块，用户可以通过Web界面完成应用的导入、配置、部署和管理操作。

#### 3.4.3.1 应用导入功能

平台支持从Git仓库导入应用，简化了应用的导入流程：

- **Git仓库配置**：通过表单输入Git仓库的URL、分支名称等。系统支持GitHub、GitLab、Bitbucket等主流代码托管平台，并会对Git URL进行格式验证，确保URL的正确性。

- **应用信息配置**：配置应用的基本信息，包括应用名称、应用类型（Web应用、API服务、后台任务、数据库）、应用描述等。应用类型用于标识应用的性质，系统会根据应用类型提供相应的部署配置选项。

- **应用创建**：点击提交按钮后，系统会将应用信息发送到后端API进行创建。后端会验证Git仓库的可访问性，并创建应用记录。创建成功后，应用会显示在应用列表中，状态为"idle"（未部署）。

![应用导入界面](images/3.4.3-application-import.png)
_图3-7 应用导入界面_

#### 3.4.3.2 应用配置功能

平台提供了灵活的应用配置功能，用户可以为应用配置部署参数：

- **端口配置**：配置应用需要暴露的端口号，支持配置多个端口，端口号以逗号分隔。系统会验证端口号的有效性（1-65535范围）。

- **健康检查配置**：配置应用的健康检查路径，用于监控应用运行状态。健康检查路径通常是一个HTTP端点，系统会定期访问该端点以检查应用的健康状态。

- **执行命令配置**：配置应用的启动命令，用于指定应用启动时执行的命令。执行命令可以是启动脚本、可执行文件等。

- **运行环境配置**：选择应用的运行环境，系统支持多种运行环境，如Python、Node.js、Java等。运行环境决定了应用运行时的基础镜像和依赖环境。

- **应用编辑**：用户可以随时编辑应用的配置信息，修改端口、健康检查路径、执行命令等参数。编辑操作通过对话框表单实现，用户可以方便地更新应用配置。

#### 3.4.3.3 应用部署功能

平台提供了一键部署功能，用户可以通过简单的操作完成应用的部署：

- **应用启动**：点击启动按钮，系统会根据应用的配置和资源可用性，自动选择合适的资源节点进行部署。启动操作会调用后端API，后端会执行以下步骤：
  1. 从Git仓库拉取应用代码
  2. 根据应用类型和运行环境构建应用镜像
  3. 根据资源调度算法选择合适的资源节点
  4. 在选定的资源节点上创建并启动容器
  5. 配置端口映射和网络连接
  6. 启动健康检查监控

- **部署状态显示**：系统会实时显示部署状态，包括"deploying"（部署中）、"running"（运行中）、"stopped"（已停止）、"error"（错误）等状态。部署状态通过颜色标识直观展示，运行中状态显示为绿色，已停止状态显示为灰色，错误状态显示为红色。

- **应用停止**：点击停止按钮，可以停止正在运行的应用。停止操作会调用后端API，后端会停止应用的容器并释放相关资源。停止后，应用状态会更新为"stopped"。

- **应用统计信息**：在应用列表页面顶部，系统会展示应用统计信息，包括应用总数、运行中的应用数、已停止的应用数、未部署的应用数、失败的应用数等，帮助用户快速了解应用的整体状态。

- **应用DAG的实时更新**：应用详情页内嵌 G6 可视化，借助 WebSocket 推送与防抖刷新机制，及时回填节点完成状态，动态呈现 Actor 组件依赖。

- **应用组件的查看**：组件管理标签页提供 DAG/列表双视图：前者展示依赖关系，后者列出镜像、资源占用、运行状态，并支持刷新、分析、部署及单组件日志查看。

- **应用日志的查看**：日志标签页支持选择最近 50/100/200/500 行日志，搭配关键字搜索与级别过滤，以滚动面板快速浏览并随时刷新。

![应用部署界面](images/3.4.4-application-deploy.png)
_图3-8 应用部署界面_

#### 3.4.3.4 应用管理功能

平台提供了完善的应用管理功能，用户可以对已创建的应用进行管理：

- **应用列表展示**：以卡片形式展示所有应用，包括应用名称、状态、类型、最后部署时间、运行资源等信息。应用卡片采用现代化的设计，提供清晰的信息展示和操作按钮。

- **应用详情查看**：点击应用卡片，可以查看应用的详细信息，包括应用配置、运行状态、日志信息等。应用详情页面提供了丰富的功能，包括代码浏览器、文件管理、组件管理等。

- **应用删除**：点击删除按钮，可以删除不再需要的应用。删除操作会先停止应用运行（如果正在运行），然后清理相关资源，最后删除应用记录。

- **应用刷新**：系统会定期自动刷新应用状态，确保应用信息的实时性。用户也可以手动刷新应用列表，获取最新的应用状态。

### 3.4.4 平台特性总结

面向算力网络的智能应用运行平台原型具有以下特性：

1. **用户友好的界面设计**：采用现代化的Web界面设计，提供直观的操作体验，降低了用户的学习成本。界面采用卡片和表格相结合的设计，信息展示清晰，操作便捷。

2. **统一的资源管理**：通过统一的界面管理多种异构算力资源，包括本地资源和远程资源，简化了资源管理操作。资源状态实时更新，资源使用情况一目了然。

3. **便捷的应用部署**：支持从Git仓库一键导入和部署应用，大大提高了应用部署的效率。应用配置灵活，支持多种应用类型和运行环境。

4. **完善的应用管理**：提供完善的应用生命周期管理功能，包括应用创建、配置、部署、停止、删除等操作，用户可以方便地管理应用的整个生命周期。

该平台原型验证了分级资源调度方法的有效性，为算力网络的资源管理和应用部署提供了实用的工具支持。通过Web界面的直观操作，用户可以方便地管理算力资源、部署应用和监控运行状态，实现了算力网络资源的高效利用和应用的便捷部署。
