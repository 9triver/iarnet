host: "host.internal" # Host for external connection. TODO: 通信问题待解决

super_admin:
  name: "admin"
  password: "123456"

peer_listen_addr: ":50051"
initial_peers:
  - "peer2.example.com:50051"
  - "peer3.example.com:50051"

data_dir: "./data"  # Directory for SQLite databases

application:
  workspace_dir: "../workspaces"
  runner_images:
    "python:3.11-latest": "iarnet/runner:python_3.11-latest"

resource:
  peer_port: 50051
  schedule_port: 50051
  global_registry_addr: "localhost:50010"
  name: "node.1"
  description: "node.1 description"
  domain_id: "domain.nwwNPjSgUFM9DCv74J8LbM"
  component_images:
    "python": "iarnet/component:python_3.11-latest"
  # 假 Provider 配置（用于演示，不参与调度）
  fake_providers:
    - name: "Fake Docker Provider 1"
      type: "docker"
      cpu: 4000        # millicores
      memory: 8Gi      # 支持字符串格式：8Gi, 8GB, 8192Mi, 512Mi 等，也支持整数字节数
      gpu: 0
      host: "provider-docker-1"  # host 格式：provider-类型-编号（无 .example.com 后缀）
      port: 50051
      resource_tags:  # 资源标签配置（可选，不配置则使用默认值：CPU=true, GPU=true, Memory=true, Camera=false）
        cpu: true
        gpu: false
        memory: true
        camera: false
      usage:  # 资源使用状态配置（可选，不配置则默认完全使用 100%）
        cpu_ratio: 0.8     # CPU 使用率 80%（0.0-1.0）
        gpu_ratio: 0.6     # GPU 使用率 60%（0.0-1.0）
        memory_ratio: 0.75 # Memory 使用率 75%（0.0-1.0）
        # 或者直接指定已使用的资源量（如果同时配置，used 优先）
        # used:
        #   cpu: 3200      # 已使用的 CPU（millicores）
        #   memory: 6Gi    # 已使用的内存（支持字符串格式如 "6Gi" 或整数字节数）
        #   gpu: 0
    - name: "Fake K8s Provider 1"
      type: "k8s"
      cpu: 8000        # millicores
      memory: 16Gi     # 支持字符串格式：8Gi, 8GB, 8192Mi, 512Mi 等，也支持整数字节数
      gpu: 2
      host: "provider-k8s-1"  # host 格式：provider-类型-编号（无 .example.com 后缀）
      port: 50051
      resource_tags:  # 资源标签配置（可选）
        cpu: true
        gpu: true
        memory: true
        camera: false
      usage:  # 资源使用状态配置（可选）
        usage_ratio: 0.6  # 使用率 60%
        # 或者直接指定已使用的资源量
        # used:
        #   cpu: 4800
        #   memory: 10307921510
        #   gpu: 1
  discovery:
    enabled: true
    gossip_interval_seconds: 30
    node_ttl_seconds: 180
    max_gossip_peers: 10
    max_hops: 5
    query_timeout_seconds: 5
    fanout: 3
    use_anti_entropy: true
    anti_entropy_interval_seconds: 300
  # 调度策略配置：用于评估和筛选跨节点委托调度的结果
  schedule_policies:
    # 资源安全裕度策略：要求可用资源至少是请求资源的 1.2 倍
    - type: resource_safety_margin
      enable: true
      params:
        cpu_ratio: 1.2      # CPU 安全系数
        memory_ratio: 1.2   # 内存安全系数
        gpu_ratio: 1.0      # GPU 安全系数（不放大）
    # 节点黑名单策略：拒绝来自黑名单节点的调度结果
    - type: node_blacklist
      enable: false         # 默认关闭，需要时启用并配置 node_ids
      params:
        node_ids: []
    # Provider 黑名单策略：拒绝来自黑名单 Provider 的调度结果
    - type: provider_blacklist
      enable: false         # 默认关闭，需要时启用并配置 provider_ids
      params:
        provider_ids: []

enable_local_docker: true

database:
  application_db_path: "./data/application.db"
  resource_provider_db_path: "./data/resource_provider.db"
  resource_logger_db_path: "./data/resource_logger.db"
  max_open_conns: 10
  max_idle_conns: 5
  conn_max_lifetime_seconds: 300  # 5 minutes

transport:
  http:
    port: 8083
  zmq:
    port: 5555
  rpc:
    resource:
      port: 50051
    ignis:
      port: 50001
    store:
      port: 50002
    logger:
      port: 50003
    resource_logger:
      port: 50004
    discovery:
      port: 50005

logging:
  enabled: true
  data_dir: "./data/logs"
  db_path: "./data/logs.db"
  chunk_duration_minutes: 5
  chunk_max_lines: 10000
  chunk_max_size_mb: 10
  compression_level: 6
  retention_days: 7
  cleanup_interval_hours: 1
  max_disk_usage_gb: 10
  buffer_size: 10000
  flush_interval_seconds: 5
  batch_size: 1000
